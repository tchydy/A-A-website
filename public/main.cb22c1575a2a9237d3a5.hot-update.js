/*! For license information please see main.cb22c1575a2a9237d3a5.hot-update.js.LICENSE.txt */
"use strict";self.webpackHotUpdatefloema("main",{"./app/components/slider.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>d});var s=i("./node_modules/prefix/index.js"),h=i.n(s),n=i("./node_modules/gsap/index.js"),r=i("./node_modules/gsap/ScrollTrigger.js"),o=i("./app/classes/detection.js");const l=(t,e,i)=>(1-i)*t+i*e;class d{constructor(t){this.el=document.querySelector(t.el),this.wrap=this.el.querySelector(t.wrap),this.items=this.el.querySelectorAll(t.item),this.bar=document.querySelector(t.bar),this.leftBtn=document.querySelector(".btn__left"),this.rightBtn=document.querySelector(".btn__right"),this.section=document.querySelector(".home__services"),this.slider=document.querySelector(".home__services__gallery"),this.DragText=document.querySelector(".cursor__text1"),this.progressNumber=document.querySelector(".home__services__nav__progress__progress__number"),this.init(),console.log("slider created"),this.inView=!1,this.centerSlide=null,this.transformPrefix=h()("transform"),n.default.registerPlugin(r.ScrollTrigger),this.scroll()}init(){this.progress=0,this.speed=0,this.oldX=0,this.x=0,this.playrate=0,this.bindings(),this.calculate(),this.activeSlide(),this.events(),this.raf()}bindings(){["events","calculate","raf","handleWheel","handleLeftClicks","handleRightClicks","move","raf","handleTouchStart","handleTouchMove","handleTouchEnd","activeSlide"].forEach((t=>{this[t]=this[t].bind(this)}))}calculate(){this.windowWidth=window.innerWidth,this.wrapWidth=this.slider.getBoundingClientRect().width,this.ItemWidth=this.wrapWidth/this.items.length,(o.default.isDesktop()||o.default.isTablet())&&(this.minScroll=this.wrap.getBoundingClientRect().left-this.ItemWidth,this.windowCenter=this.windowWidth/2+.25*this.ItemWidth,this.windowLeft=this.windowWidth/2-.75*this.ItemWidth),o.default.isPhone()&&(this.minScroll=this.wrap.getBoundingClientRect().left,this.windowCenter=this.windowWidth/2+.25*this.ItemWidth,this.windowLeft=this.minScroll-20,console.log(this.windowLeft,this.windowCenter)),this.maxScroll=this.wrapWidth-this.el.clientWidth-this.minScroll,this.sectionTop=this.section.getBoundingClientRect().top}activeSlide(){this.items.forEach(((t,e)=>{this.itemBoundsLeft=t.getBoundingClientRect().left,this.isCenter=this.itemBoundsLeft<this.windowCenter&&this.itemBoundsLeft>this.windowLeft,this.isCenter?(this.centerSlide=t,this.centerSlideIndex=e,this.centerSlide.classList.add("active")):t.classList.remove("active")}))}activeSlideClick(){this.items.forEach(((t,e)=>{this.rightClick?this.itemBoundsLeft=t.getBoundingClientRect().left-this.ItemWidth:this.itemBoundsLeft=t.getBoundingClientRect().left+this.ItemWidth,this.isCenter=this.itemBoundsLeft<this.windowCenter&&this.itemBoundsLeft>this.windowLeft,this.isCenter?(this.centerSlide=t,this.centerSlideIndex=e,this.centerSlide.classList.add("active")):t.classList.remove("active")}))}handleWheel(t){this.inView&&(this.inView?this.progress+=t.deltaY:this.progress=0,this.move())}handleLeftClicks(t){this.rightClick=!1,this.progress-=this.ItemWidth,this.activeSlideClick(),this.progress<=this.minScroll-100&&(console.log("gallery start",this.items[0].getBoundingClientRect().left),this.slideEnd=this.items[this.items.length-1],this.progress-=this.ItemWidth,this.items.forEach(((t,e)=>{t.classList.remove("active")})),this.progress=0,setTimeout((()=>{this.progress=this.maxScroll,this.slideEnd.classList.add("active"),this.centerSlideIndex=this.items.length-1}),1e3))}handleRightClicks(t){this.clicked=!0,this.rightClick=!0,this.progress+=this.ItemWidth,this.activeSlideClick(),this.progress>=this.maxScroll&&(this.slideStart=this.items[0],this.items.forEach(((t,e)=>{t.classList.remove("active")})),this.progress=this.maxScroll,setTimeout((()=>{this.progress=this.minScroll,this.slideStart.classList.add("active"),this.centerSlideIndex=0}),1e3))}handleTouchStart(t){t.preventDefault(),this.inView&&(this.dragging=!0,this.startX=t.clientX||t.touches[0].clientX,this.el.classList.add("dragging"),this.DragText.classList.add("none"),this.click=!1)}handleTouchMove(t){if(this.click=!1,!this.inView)return;if(!this.dragging)return!1;const e=t.clientX||t.touches[0].clientX;this.progress+=2.5*(this.startX-e),this.startX=e,this.move()}handleTouchEnd(){this.click=!1,this.inView&&(this.dragging=!1,this.el.classList.remove("dragging"),this.DragText.classList.remove("none"))}move(){var t,e,i;this.click=!1,this.progress=(t=this.progress,e=this.minScroll,i=this.maxScroll,Math.max(e,Math.min(t,i))),this.activeSlide()}events(){window.addEventListener("resize",this.calculate),window.addEventListener("wheel",this.handleWheel),this.rightBtn.addEventListener("click",this.handleRightClicks),this.leftBtn.addEventListener("click",this.handleLeftClicks),this.section.addEventListener("touchstart",this.handleTouchStart),window.addEventListener("touchmove",this.handleTouchMove),window.addEventListener("touchend",this.handleTouchEnd),window.addEventListener("mousedown",this.handleTouchStart),window.addEventListener("mousemove",this.handleTouchMove),window.addEventListener("mouseup",this.handleTouchEnd),document.body.addEventListener("mouseleave",this.handleTouchEnd)}scroll(){const t=this;this.slideY=this.wrapWidth+this.ItemWidth-window.innerWidth,this.tl=n.default.timeline({scrollTrigger:{trigger:".home__about",start:"bottom 10%",toggleActions:"restart complete none reset"}}),this.tl.to(".home__about__scrolltext .word",{y:"100%",opacity:0,duration:.5}),this.tl1=n.default.timeline({scrollTrigger:{trigger:".home__services",start:"top top",end:`+=${this.slideY}`,toggleActions:"restart complete none reset",pin:!0,scrub:1,onEnter:function(){t.section.classList.add("in-view")},onLeave:function(){t.DragText.classList.add("none"),t.section.classList.remove("in-view")},onLeaveBack:function(){t.DragText.classList.add("none"),t.section.classList.remove("in-view")},onEnterBack:function(){t.section.classList.add("in-view"),t.DragText.classList.remove("none")}}}),this.tl.to(".home__services",{opacity:1,delay:5,duration:.5,ease:"expo.out",onComplete:function(){t.inView=!0,t.DragText.classList.remove("none")}}).to(".home__services__gallery ",{y:this.wrapWidth}),this.section.classList.contains("in-view")||this.DragText.classList.add("none")}moveSlider(){this.sectionTop=this.section.getBoundingClientRect().top,this.raf()}raf(){this.inView&&(this.x=l(this.x,this.progress,.1),this.playrate=this.x/this.maxScroll,this.progressNum=this.centerSlideIndex+1,this.progressNumber.innerHTML=`0${this.progressNum}/07`,this.wrap.style[this.transformPrefix]=`translateX(${-this.x}px)`,this.bar.style[this.transformPrefix]=`scaleX(${.18+.82*this.playrate})`,this.speed=Math.min(100,this.oldX-this.x),this.oldX=this.x,this.scale=l(this.scale,this.speed,.1),this.items.forEach((t=>{t.style[this.transformPrefix]=`scale(${1-.002*Math.abs(this.speed)})`,t.querySelector("img").style[this.transformPrefix]=`scaleX(${1+.004*Math.abs(this.speed)})`})))}}}},(function(t){t.h=()=>"6b0a3382faa459145cfa"}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RzNDMUQsS0FBS2MsZUFBZW9HLFVBQWEsSUFBR2xILEtBQUtpSCxpQkFFekNqSCxLQUFLSSxLQUFLK0csTUFBTW5ILEtBQUtvQixpQkFBb0IsZUFBY3BCLEtBQUs0QixPQUM1RDVCLEtBQUtRLElBQUkyRyxNQUFNbkgsS0FBS29CLGlCQUFvQixVQUFTLElBQXVCLElBQWhCcEIsS0FBSzZCLFlBRTdEN0IsS0FBSzBCLE1BQVE0RCxLQUFLRixJQUFJLElBQUtwRixLQUFLMkIsS0FBTzNCLEtBQUs0QixHQUM1QzVCLEtBQUsyQixLQUFPM0IsS0FBSzRCLEVBRWpCNUIsS0FBS29ILE1BQVEzSCxFQUFLTyxLQUFLb0gsTUFBT3BILEtBQUswQixNQUFPLElBQzFDMUIsS0FBS0ssTUFBTThCLFNBQVNDLElBQ2xCQSxFQUFFK0UsTUFBTW5ILEtBQUtvQixpQkFBb0IsU0FBUSxFQUEyQixLQUF2QmtFLEtBQUsrQixJQUFJckgsS0FBSzBCLFVBQzNEVSxFQUFFakMsY0FBYyxPQUFPZ0gsTUFBTW5ILEtBQUtvQixpQkFBb0IsVUFDcEQsRUFBMkIsS0FBdkJrRSxLQUFLK0IsSUFBSXJILEtBQUswQiwrQkN4WDFCNEYsRUFBb0JDLEVBQUksSUFBTSIsInNvdXJjZXMiOlsid2VicGFjazovL2Zsb2VtYS8uL2FwcC9jb21wb25lbnRzL3NsaWRlci5qcyIsIndlYnBhY2s6Ly9mbG9lbWEvd2VicGFjay9ydW50aW1lL2dldEZ1bGxIYXNoIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBQcmVmaXggZnJvbSBcInByZWZpeFwiXG5pbXBvcnQgZ3NhcCBmcm9tIFwiZ3NhcFwiO1xuaW1wb3J0IHsgU2Nyb2xsVHJpZ2dlciB9IGZyb20gJ2dzYXAvU2Nyb2xsVHJpZ2dlcic7XG5pbXBvcnQgRGV0ZWN0aW9uIGZyb20gJy4uL2NsYXNzZXMvZGV0ZWN0aW9uJ1xuXG5jb25zdCBsZXJwID0gKGYwLCBmMSwgdCkgPT4gKDEgLSB0KSAqIGYwICsgdCAqIGYxO1xuY29uc3QgY2xhbXAgPSAodmFsLCBtaW4sIG1heCkgPT4gTWF0aC5tYXgobWluLCBNYXRoLm1pbih2YWwsIG1heCkpO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEcmFnU2Nyb2xsIHtcbiAgY29uc3RydWN0b3Iob2JqKSB7XG4gICAgdGhpcy5lbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iob2JqLmVsKTtcbiAgICB0aGlzLndyYXAgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3Iob2JqLndyYXApO1xuICAgIHRoaXMuaXRlbXMgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwob2JqLml0ZW0pO1xuICAgIHRoaXMuYmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvYmouYmFyKTtcbiAgICB0aGlzLmxlZnRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnRuX19sZWZ0Jyk7XG4gICAgdGhpcy5yaWdodEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idG5fX3JpZ2h0Jyk7XG4gICAgLy8gdGhpcy5zZWN0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhvbWVfX3NlcnZpY2VzX19nYWxsZXJ5Jyk7XG4gICAgdGhpcy5zZWN0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhvbWVfX3NlcnZpY2VzJyk7XG4gICAgdGhpcy5zbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaG9tZV9fc2VydmljZXNfX2dhbGxlcnknKTtcbiAgICB0aGlzLkRyYWdUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmN1cnNvcl9fdGV4dDEnKTtcbiAgICB0aGlzLnByb2dyZXNzTnVtYmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICcuaG9tZV9fc2VydmljZXNfX25hdl9fcHJvZ3Jlc3NfX3Byb2dyZXNzX19udW1iZXInXG4gICAgKTtcbiAgICB0aGlzLmluaXQoKTtcbiAgICBjb25zb2xlLmxvZygnc2xpZGVyIGNyZWF0ZWQnKTtcblxuICAgIHRoaXMuaW5WaWV3ID0gZmFsc2U7XG4gICAgLy8ga2VlcCB0cmFjayBvZiBhY3RpdmUgc2xpZGVcbiAgICB0aGlzLmNlbnRlclNsaWRlID0gbnVsbFxuXG4gICAgdGhpcy50cmFuc2Zvcm1QcmVmaXggPSBQcmVmaXgoJ3RyYW5zZm9ybScpO1xuICAgIGdzYXAucmVnaXN0ZXJQbHVnaW4oU2Nyb2xsVHJpZ2dlcik7XG4gICAgdGhpcy5zY3JvbGwoKTtcbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgdGhpcy5wcm9ncmVzcyA9IDA7XG4gICAgLy8gdGhpcy5taW5TY3JvbGwgPSAwO1xuICAgIHRoaXMuc3BlZWQgPSAwO1xuICAgIHRoaXMub2xkWCA9IDA7XG4gICAgdGhpcy54ID0gMDtcbiAgICB0aGlzLnBsYXlyYXRlID0gMDtcbiAgICAvL1xuICAgIHRoaXMuYmluZGluZ3MoKTtcbiAgICB0aGlzLmNhbGN1bGF0ZSgpO1xuICAgIHRoaXMuYWN0aXZlU2xpZGUoKVxuICAgIHRoaXMuZXZlbnRzKCk7XG4gICAgdGhpcy5yYWYoKTtcbiAgfVxuXG4gIGJpbmRpbmdzKCkge1xuICAgIFtcbiAgICAgICdldmVudHMnLFxuICAgICAgJ2NhbGN1bGF0ZScsXG4gICAgICAncmFmJyxcbiAgICAgICdoYW5kbGVXaGVlbCcsXG4gICAgICAnaGFuZGxlTGVmdENsaWNrcycsXG4gICAgICAnaGFuZGxlUmlnaHRDbGlja3MnLFxuICAgICAgJ21vdmUnLFxuICAgICAgJ3JhZicsXG4gICAgICAnaGFuZGxlVG91Y2hTdGFydCcsXG4gICAgICAnaGFuZGxlVG91Y2hNb3ZlJyxcbiAgICAgICdoYW5kbGVUb3VjaEVuZCcsXG4gICAgICAnYWN0aXZlU2xpZGUnLFxuICAgIF0uZm9yRWFjaCgoaSkgPT4ge1xuICAgICAgdGhpc1tpXSA9IHRoaXNbaV0uYmluZCh0aGlzKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNhbGN1bGF0ZSgpIHtcbiAgICB0aGlzLndpbmRvd1dpZHRoID0gd2luZG93LmlubmVyV2lkdGhcbiAgICB0aGlzLndyYXBXaWR0aCA9IHRoaXMuc2xpZGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoO1xuICAgIHRoaXMuSXRlbVdpZHRoID0gdGhpcy53cmFwV2lkdGggLyB0aGlzLml0ZW1zLmxlbmd0aDtcbiAgICBpZiAoRGV0ZWN0aW9uLmlzRGVza3RvcCgpIHx8IERldGVjdGlvbi5pc1RhYmxldCgpKSB7XG4gICAgICB0aGlzLm1pblNjcm9sbCA9IHRoaXMud3JhcC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0IC0gdGhpcy5JdGVtV2lkdGg7XG4gICAgICB0aGlzLndpbmRvd0NlbnRlciA9IHRoaXMud2luZG93V2lkdGggLyAyICsgdGhpcy5JdGVtV2lkdGggKiAwLjI1O1xuICAgICAgdGhpcy53aW5kb3dMZWZ0ID0gdGhpcy53aW5kb3dXaWR0aCAvIDIgLSB0aGlzLkl0ZW1XaWR0aCAqIDAuNzU7XG4gICAgfVxuICAgIGlmIChEZXRlY3Rpb24uaXNQaG9uZSgpKXtcbiAgICAgIHRoaXMubWluU2Nyb2xsID0gdGhpcy53cmFwLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnRcbiAgICAgIHRoaXMud2luZG93Q2VudGVyID0gdGhpcy53aW5kb3dXaWR0aCAvIDIgKyB0aGlzLkl0ZW1XaWR0aCAqIDAuMjU7XG4gICAgICB0aGlzLndpbmRvd0xlZnQgPSB0aGlzLm1pblNjcm9sbCAtIDIwO1xuXHRcdFx0Y29uc29sZS5sb2codGhpcy53aW5kb3dMZWZ0LCB0aGlzLndpbmRvd0NlbnRlcilcbiAgICB9XG4gICAgICAvLyB0aGlzLndyYXAuc3R5bGUud2lkdGggPSBgJHt0aGlzLndyYXBXaWR0aH1weGA7XG4gICAgICB0aGlzLm1heFNjcm9sbCA9IHRoaXMud3JhcFdpZHRoIC0gdGhpcy5lbC5jbGllbnRXaWR0aCAtIHRoaXMubWluU2Nyb2xsO1xuICAgIC8vIC0gdGhpcy5taW5TY3JvbGw7XG4gICAgdGhpcy5zZWN0aW9uVG9wID0gdGhpcy5zZWN0aW9uLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcbiAgfVxuXG4gIGFjdGl2ZVNsaWRlICgpIHtcbiAgICAvLyBDbGlja1xuICAgIHRoaXMuaXRlbXMuZm9yRWFjaCggKGl0ZW0sIGluZGV4KSA9PiB7XG5cbiAgICAgIHRoaXMuaXRlbUJvdW5kc0xlZnQgPSBpdGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnRcblxuICAgICAgLy8gY29uc3QgaXRlbVRpdGxlU3BhbnMgPSBpdGVtLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NwYW4nKVxuXG4gICAgICB0aGlzLmlzQ2VudGVyID1cbiAgICAgICAgdGhpcy5pdGVtQm91bmRzTGVmdCA8IHRoaXMud2luZG93Q2VudGVyICYmXG4gICAgICAgIHRoaXMuaXRlbUJvdW5kc0xlZnQgPiB0aGlzLndpbmRvd0xlZnQ7XG5cbiAgICAgIGlmICh0aGlzLmlzQ2VudGVyKSB7XG4gICAgICAgIHRoaXMuY2VudGVyU2xpZGUgPSBpdGVtXG4gICAgICAgIHRoaXMuY2VudGVyU2xpZGVJbmRleCA9IGluZGV4O1xuICAgICAgICB0aGlzLmNlbnRlclNsaWRlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhcbiAgICAgICAgLy8gICBpdGVtVGl0bGVTcGFuc1swXS5pbm5lckhUTUwsXG4gICAgICAgIC8vICAgdGhpcy5jZW50ZXJTbGlkZSxcbiAgICAgICAgLy8gICB0aGlzLml0ZW1Cb3VuZHNMZWZ0LFxuICAgICAgICAvLyAgIHRoaXMud2luZG93TGVmdCxcbiAgICAgICAgLy8gICB0aGlzLndpbmRvd0NlbnRlclxuICAgICAgICAvLyApO1xuICAgICAgICAvLyByZW1vdmUgYWN0aXZlIGNsYXNzIGZyb20gcHJldmlvdXMgYW5kIGFkZCB0byBjdXJyZW50XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXG4gICAgICB9XG5cbiAgICB9KVxuICB9XG5cbiAgYWN0aXZlU2xpZGVDbGljayAoKSB7XG4gICAgICB0aGlzLml0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnJpZ2h0Q2xpY2spIHtcbiAgICAgICAgICB0aGlzLml0ZW1Cb3VuZHNMZWZ0ID1cbiAgICAgICAgICAgIGl0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCAtIHRoaXMuSXRlbVdpZHRoO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3JpZ2h0IGNsaWNrJyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaXRlbUJvdW5kc0xlZnQgPVxuICAgICAgICAgICAgaXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0ICsgdGhpcy5JdGVtV2lkdGg7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnbGVmdCBjbGljaycpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY29uc3QgaXRlbVRpdGxlU3BhbnMgPSBpdGVtLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NwYW4nKTtcblxuICAgICAgICB0aGlzLmlzQ2VudGVyID1cbiAgICAgICAgICB0aGlzLml0ZW1Cb3VuZHNMZWZ0IDwgdGhpcy53aW5kb3dDZW50ZXIgJiZcbiAgICAgICAgICB0aGlzLml0ZW1Cb3VuZHNMZWZ0ID4gdGhpcy53aW5kb3dMZWZ0O1xuXG4gICAgICAgIGlmICh0aGlzLmlzQ2VudGVyKSB7XG4gICAgICAgICAgdGhpcy5jZW50ZXJTbGlkZSA9IGl0ZW07XG4gICAgICAgICAgdGhpcy5jZW50ZXJTbGlkZUluZGV4ID0gaW5kZXhcbiAgICAgICAgICB0aGlzLmNlbnRlclNsaWRlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFxuICAgICAgICAgIC8vICAgaXRlbVRpdGxlU3BhbnNbMF0uaW5uZXJIVE1MLFxuICAgICAgICAgIC8vICAgdGhpcy5jZW50ZXJTbGlkZSxcbiAgICAgICAgICAvLyAgIHRoaXMuaXRlbUJvdW5kc0xlZnQsXG4gICAgICAgICAgLy8gICB0aGlzLndpbmRvd0xlZnQsXG4gICAgICAgICAgLy8gICB0aGlzLndpbmRvd0NlbnRlclxuICAgICAgICAgIC8vICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cblxuICBoYW5kbGVXaGVlbChlKSB7XG4gICAgaWYgKCF0aGlzLmluVmlldykgcmV0dXJuO1xuICAgIGlmICghdGhpcy5pblZpZXcpIHtcbiAgICAgIHRoaXMucHJvZ3Jlc3MgPSAwXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucHJvZ3Jlc3MgKz0gZS5kZWx0YVk7XG4gIH1cbiAgdGhpcy5tb3ZlKCk7XG59XG5cbmhhbmRsZUxlZnRDbGlja3MoZSkge1xuXHR0aGlzLnJpZ2h0Q2xpY2sgPSBmYWxzZVxuICB0aGlzLnByb2dyZXNzIC09IHRoaXMuSXRlbVdpZHRoO1xuICB0aGlzLmFjdGl2ZVNsaWRlQ2xpY2soKTtcblxuICAvLyBpZiBhdCB0aGUgc3RhcnQgb2YgZ2FsbGVyeSBtb3ZlIHRvIGVuZCBvZiBzbGlkZVxuICBpZiAodGhpcy5wcm9ncmVzcyA8PSAodGhpcy5taW5TY3JvbGwgLTEwMCApKSB7XG4gICAgY29uc29sZS5sb2coJ2dhbGxlcnkgc3RhcnQnLCB0aGlzLml0ZW1zWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQpO1xuICAgIHRoaXMuc2xpZGVFbmQgPSB0aGlzLml0ZW1zW3RoaXMuaXRlbXMubGVuZ3RoIC0gMV07XG5cbiAgICB0aGlzLnByb2dyZXNzIC09ICh0aGlzLkl0ZW1XaWR0aCApO1xuICAgIC8vIHJlbW92ZSBhY3RpdmUgY2xhc3NcbiAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaCggKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICB9XG4gICAgIClcblxuICAgICB0aGlzLnByb2dyZXNzID0gMDtcblxuICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICB0aGlzLnByb2dyZXNzID0gdGhpcy5tYXhTY3JvbGw7XG4gICAgICAgdGhpcy5zbGlkZUVuZC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxuICAgICAgIHRoaXMuY2VudGVyU2xpZGVJbmRleCA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTtcbiAgICAgIH0sIDEwMDApO1xuICAgIH1cbiAgfVxuXG4gIGhhbmRsZVJpZ2h0Q2xpY2tzKGUpIHtcblx0XHR0aGlzLmNsaWNrZWQgPSB0cnVlO1xuXHRcdHRoaXMucmlnaHRDbGljayA9IHRydWU7XG4gICAgdGhpcy5wcm9ncmVzcyArPSB0aGlzLkl0ZW1XaWR0aDtcbiAgICB0aGlzLmFjdGl2ZVNsaWRlQ2xpY2soKTtcbiAgICAvLyBpZiBhdCB0aGUgZW5kIG9mIGdhbGxlcnkgbW92ZSB0byBzdGFydCBvZiBzbGlkZVxuICAgIGlmICh0aGlzLnByb2dyZXNzID49IHRoaXMubWF4U2Nyb2xsKSB7XG4gICAgICB0aGlzLnNsaWRlU3RhcnQgPSB0aGlzLml0ZW1zWzBdO1xuXG4gICAgICAvLyByZW1vdmUgYWN0aXZlIGNsYXNzXG4gICAgICB0aGlzLml0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5wcm9ncmVzcyA9IHRoaXMubWF4U2Nyb2xsO1xuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy5wcm9ncmVzcyA9IHRoaXMubWluU2Nyb2xsO1xuICAgICAgICB0aGlzLnNsaWRlU3RhcnQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgIHRoaXMuY2VudGVyU2xpZGVJbmRleCA9IDBcbiAgICAgIH0sIDEwMDApO1xuICAgIH1cbiAgICAvLyBjb25zb2xlLmxvZygnZ2FsbGVyeSBlbmQnLCB0aGlzLml0ZW1zWzBdKTtcbiAgfVxuXG4gIGhhbmRsZVRvdWNoU3RhcnQoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBpZighdGhpcy5pblZpZXcpIHJldHVybjtcbiAgICB0aGlzLmRyYWdnaW5nID0gdHJ1ZTtcbiAgICB0aGlzLnN0YXJ0WCA9IGUuY2xpZW50WCB8fCBlLnRvdWNoZXNbMF0uY2xpZW50WDtcbiAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ2RyYWdnaW5nJyk7XG4gICAgdGhpcy5EcmFnVGV4dC5jbGFzc0xpc3QuYWRkKCdub25lJylcbiAgICB0aGlzLmNsaWNrID0gZmFsc2VcbiAgfVxuXG4gIGhhbmRsZVRvdWNoTW92ZShlKSB7XG4gICAgdGhpcy5jbGljayA9IGZhbHNlXG4gICAgaWYoIXRoaXMuaW5WaWV3KSByZXR1cm47XG4gICAgaWYgKCF0aGlzLmRyYWdnaW5nKSByZXR1cm4gZmFsc2U7XG4gICAgLy8gY29uc3QgeCA9IGUudG91Y2hlcyA/IGUudG91Y2hlc1swXS5jbGllbnRYIDogZS5jbGllbnRYO1xuICAgIGNvbnN0IHggPSBlLmNsaWVudFggfHwgZS50b3VjaGVzWzBdLmNsaWVudFg7XG4gICAgdGhpcy5wcm9ncmVzcyArPSAodGhpcy5zdGFydFggLSB4KSAqIDIuNTtcbiAgICB0aGlzLnN0YXJ0WCA9IHg7XG4gICAgdGhpcy5tb3ZlKCk7XG4gICAgLy8gY29uc29sZS5sb2codGhpcy5wcm9ncmVzcyk7XG4gIH1cblxuICBoYW5kbGVUb3VjaEVuZCgpIHtcbiAgICB0aGlzLmNsaWNrID0gZmFsc2U7XG4gICAgaWYoIXRoaXMuaW5WaWV3KSByZXR1cm47XG4gICAgdGhpcy5kcmFnZ2luZyA9IGZhbHNlO1xuICAgIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZ2dpbmcnKTtcbiAgICB0aGlzLkRyYWdUZXh0LmNsYXNzTGlzdC5yZW1vdmUoJ25vbmUnKTtcbiAgfVxuXG5cbiAgbW92ZSgpIHtcbiAgICB0aGlzLmNsaWNrID0gZmFsc2U7XG4gICAgdGhpcy5wcm9ncmVzcyA9IGNsYW1wKHRoaXMucHJvZ3Jlc3MsIHRoaXMubWluU2Nyb2xsLCB0aGlzLm1heFNjcm9sbCk7XG4gICAgICB0aGlzLmFjdGl2ZVNsaWRlKCk7XG5cbiAgfVxuXG4gIGV2ZW50cygpIHtcbiAgICAvLyBpZighdGhpcy5pblZpZXcpIHJldHVybjtpZighdGhpcy5pblZpZXcpIHJldHVybjtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5jYWxjdWxhdGUpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIHRoaXMuaGFuZGxlV2hlZWwpO1xuICAgIC8vXG4gICAgdGhpcy5yaWdodEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlUmlnaHRDbGlja3MpO1xuICAgIHRoaXMubGVmdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlTGVmdENsaWNrcyk7XG4gICAgLy9cbiAgICB0aGlzLnNlY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMuaGFuZGxlVG91Y2hTdGFydCk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMuaGFuZGxlVG91Y2hNb3ZlKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLmhhbmRsZVRvdWNoRW5kKTtcbiAgICAvL1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmhhbmRsZVRvdWNoU3RhcnQpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLmhhbmRsZVRvdWNoTW92ZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLmhhbmRsZVRvdWNoRW5kKTtcbiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCB0aGlzLmhhbmRsZVRvdWNoRW5kKTtcblxuICB9XG5cbiAgc2Nyb2xsKCkge1xuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuc2xpZGVZID0gdGhpcy53cmFwV2lkdGggKyB0aGlzLkl0ZW1XaWR0aCAtIHdpbmRvdy5pbm5lcldpZHRoO1xuICAgIHRoaXMudGwgPSBnc2FwLnRpbWVsaW5lKHtcbiAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgdHJpZ2dlcjogJy5ob21lX19hYm91dCcsXG4gICAgICAgIHN0YXJ0OiAnYm90dG9tIDEwJScsXG4gICAgICAgIHRvZ2dsZUFjdGlvbnM6ICdyZXN0YXJ0IGNvbXBsZXRlIG5vbmUgcmVzZXQnLFxuICAgICAgICAvLyBtYXJrZXJzOiB0cnVlLFxuICAgICAgfSxcbiAgICB9KTtcbiAgICB0aGlzLnRsXG4gICAgICAudG8oJy5ob21lX19hYm91dF9fc2Nyb2xsdGV4dCAud29yZCcsIHtcbiAgICAgICAgeTogJzEwMCUnLFxuICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgICBkdXJhdGlvbjogMC41LFxuICAgICAgfSlcblxuXG4gICAgIHRoaXMudGwxID0gZ3NhcC50aW1lbGluZSh7XG4gICAgICAgc2Nyb2xsVHJpZ2dlcjoge1xuICAgICAgICAgdHJpZ2dlcjogJy5ob21lX19zZXJ2aWNlcycsXG4gICAgICAgICBzdGFydDogJ3RvcCB0b3AnLFxuICAgICAgICAgLy8gIGVuZDogYCs9JHt0aGlzLndyYXBXaWR0aH0gYm90dG9tYCxcbiAgICAgICAgIGVuZDogYCs9JHt0aGlzLnNsaWRlWX1gLFxuICAgICAgICAgdG9nZ2xlQWN0aW9uczogJ3Jlc3RhcnQgY29tcGxldGUgbm9uZSByZXNldCcsXG4gICAgICAgIC8vICBtYXJrZXJzOiB0cnVlLFxuICAgICAgICAgcGluOiB0cnVlLFxuICAgICAgICAgc2NydWI6IDEsXG4gICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2VsZi5zZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ2luLXZpZXcnKVxuICAgICAgICB9LFxuICAgICAgICBvbkxlYXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2coJ2FkZCBub25lJyk7XG4gICAgICAgICAgc2VsZi5EcmFnVGV4dC5jbGFzc0xpc3QuYWRkKCdub25lJyk7XG4gICAgICAgICAgc2VsZi5zZWN0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2luLXZpZXcnKVxuICAgICAgICB9LFxuICAgICAgICBvbkxlYXZlQmFjazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHNlbGYuRHJhZ1RleHQuY2xhc3NMaXN0LmFkZCgnbm9uZScpO1xuICAgICAgICAgIHNlbGYuc2VjdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdpbi12aWV3JylcbiAgICAgICAgfSxcbiAgICAgICAgb25FbnRlckJhY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZygnYWRkIG5vbmUnKTtcbiAgICAgICAgICBzZWxmLnNlY3Rpb24uY2xhc3NMaXN0LmFkZCgnaW4tdmlldycpXG4gICAgICAgICAgIHNlbGYuRHJhZ1RleHQuY2xhc3NMaXN0LnJlbW92ZSgnbm9uZScpO1xuICAgICAgICAgfSxcbiAgICAgICB9LFxuICAgICB9KTtcbiAgICAgdGhpcy50bFxuICAgICAudG8oXG4gICAgICAgICcuaG9tZV9fc2VydmljZXMnLFxuICAgICAgICB7XG4gICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICBkZWxheTogNSxcbiAgICAgICAgICBkdXJhdGlvbjogMC41LFxuICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgb25Db21wbGV0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi5pblZpZXcgPSB0cnVlO1xuICAgICAgICAgICAgc2VsZi5EcmFnVGV4dC5jbGFzc0xpc3QucmVtb3ZlKCdub25lJyk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnb3BhY2l0eSAxJywgc2VsZi5pblZpZXcpO1xuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIClcbiAgICAgLnRvKCcuaG9tZV9fc2VydmljZXNfX2dhbGxlcnkgJywge1xuICAgICAgIHk6IHRoaXMud3JhcFdpZHRoLFxuICAgICB9KTtcblxuICAgICBpZighdGhpcy5zZWN0aW9uLmNsYXNzTGlzdC5jb250YWlucygnaW4tdmlldycpKSB7XG4gICAgICB0aGlzLkRyYWdUZXh0LmNsYXNzTGlzdC5hZGQoJ25vbmUnKVxuICAgICB9XG4gIH1cblxuICBtb3ZlU2xpZGVyICgpIHtcbiAgICB0aGlzLnNlY3Rpb25Ub3AgPSB0aGlzLnNlY3Rpb24uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMucHJvZ3Jlc3MsIHRoaXMubWF4U2Nyb2xsLCB0aGlzLnNlY3Rpb25Ub3ApO1xuICAgIHRoaXMucmFmKClcblxuICB9XG5cbiAgcmFmKCkge1xuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuaW5WaWV3KTtcbiAgICBpZighdGhpcy5pblZpZXcpIHJldHVyblxuICAgIHRoaXMueCA9IGxlcnAodGhpcy54LCB0aGlzLnByb2dyZXNzLCAwLjEpO1xuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMueCwgdGhpcy5wcm9ncmVzcylcbiAgICB0aGlzLnBsYXlyYXRlID0gdGhpcy54IC8gdGhpcy5tYXhTY3JvbGw7XG4gICAgLy8gdGhpcy5wcm9ncmVzc051bSA9IE1hdGgucm91bmQoKDAuMTggKyB0aGlzLnBsYXlyYXRlICogMC44MikgKiA3KTtcbiAgICB0aGlzLnByb2dyZXNzTnVtID0gdGhpcy5jZW50ZXJTbGlkZUluZGV4ICsgMTtcbiAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmNlbnRlclNsaWRlSW5kZXggKyAxKTtcbiAgICAvL1xuICAgIHRoaXMucHJvZ3Jlc3NOdW1iZXIuaW5uZXJIVE1MID0gYDAke3RoaXMucHJvZ3Jlc3NOdW19LzA3YFxuICAgIC8vXG4gICAgdGhpcy53cmFwLnN0eWxlW3RoaXMudHJhbnNmb3JtUHJlZml4XSA9IGB0cmFuc2xhdGVYKCR7LXRoaXMueH1weClgO1xuICAgIHRoaXMuYmFyLnN0eWxlW3RoaXMudHJhbnNmb3JtUHJlZml4XSA9IGBzY2FsZVgoJHswLjE4ICsgdGhpcy5wbGF5cmF0ZSAqIDAuODJ9KWA7XG4gICAgLy9cbiAgICB0aGlzLnNwZWVkID0gTWF0aC5taW4oMTAwLCB0aGlzLm9sZFggLSB0aGlzLngpO1xuICAgIHRoaXMub2xkWCA9IHRoaXMueDtcbiAgICAvL1xuICAgIHRoaXMuc2NhbGUgPSBsZXJwKHRoaXMuc2NhbGUsIHRoaXMuc3BlZWQsIDAuMSk7XG4gICAgdGhpcy5pdGVtcy5mb3JFYWNoKChpKSA9PiB7XG4gICAgICBpLnN0eWxlW3RoaXMudHJhbnNmb3JtUHJlZml4XSA9IGBzY2FsZSgkezEgLSBNYXRoLmFicyh0aGlzLnNwZWVkKSAqIDAuMDAyfSlgO1xuICAgICAgaS5xdWVyeVNlbGVjdG9yKCdpbWcnKS5zdHlsZVt0aGlzLnRyYW5zZm9ybVByZWZpeF0gPSBgc2NhbGVYKCR7XG4gICAgICAgIDEgKyBNYXRoLmFicyh0aGlzLnNwZWVkKSAqIDAuMDA0XG4gICAgICB9KWA7XG4gICAgfSk7XG4gIH1cbn1cblxuLyoqXG4gKiBJbnN0YW5jZXNcbiAqL1xuXG5cblxuXG5cbi8qKlxuICogT25lIHJhZiB0byBydWxlIGVtIGFsbFxuICovXG5cblxuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmggPSAoKSA9PiAoXCI2YjBhMzM4MmZhYTQ1OTE0NWNmYVwiKSJdLCJuYW1lcyI6WyJsZXJwIiwiZjAiLCJmMSIsInQiLCJEcmFnU2Nyb2xsIiwiY29uc3RydWN0b3IiLCJvYmoiLCJ0aGlzIiwiZWwiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJ3cmFwIiwiaXRlbXMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaXRlbSIsImJhciIsImxlZnRCdG4iLCJyaWdodEJ0biIsInNlY3Rpb24iLCJzbGlkZXIiLCJEcmFnVGV4dCIsInByb2dyZXNzTnVtYmVyIiwiaW5pdCIsImNvbnNvbGUiLCJsb2ciLCJpblZpZXciLCJjZW50ZXJTbGlkZSIsInRyYW5zZm9ybVByZWZpeCIsIlByZWZpeCIsImdzYXAiLCJTY3JvbGxUcmlnZ2VyIiwic2Nyb2xsIiwicHJvZ3Jlc3MiLCJzcGVlZCIsIm9sZFgiLCJ4IiwicGxheXJhdGUiLCJiaW5kaW5ncyIsImNhbGN1bGF0ZSIsImFjdGl2ZVNsaWRlIiwiZXZlbnRzIiwicmFmIiwiZm9yRWFjaCIsImkiLCJiaW5kIiwid2luZG93V2lkdGgiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwid3JhcFdpZHRoIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwid2lkdGgiLCJJdGVtV2lkdGgiLCJsZW5ndGgiLCJEZXRlY3Rpb24iLCJtaW5TY3JvbGwiLCJsZWZ0Iiwid2luZG93Q2VudGVyIiwid2luZG93TGVmdCIsIm1heFNjcm9sbCIsImNsaWVudFdpZHRoIiwic2VjdGlvblRvcCIsInRvcCIsImluZGV4IiwiaXRlbUJvdW5kc0xlZnQiLCJpc0NlbnRlciIsImNlbnRlclNsaWRlSW5kZXgiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJhY3RpdmVTbGlkZUNsaWNrIiwicmlnaHRDbGljayIsImhhbmRsZVdoZWVsIiwiZSIsImRlbHRhWSIsIm1vdmUiLCJoYW5kbGVMZWZ0Q2xpY2tzIiwic2xpZGVFbmQiLCJzZXRUaW1lb3V0IiwiaGFuZGxlUmlnaHRDbGlja3MiLCJjbGlja2VkIiwic2xpZGVTdGFydCIsImhhbmRsZVRvdWNoU3RhcnQiLCJwcmV2ZW50RGVmYXVsdCIsImRyYWdnaW5nIiwic3RhcnRYIiwiY2xpZW50WCIsInRvdWNoZXMiLCJjbGljayIsImhhbmRsZVRvdWNoTW92ZSIsImhhbmRsZVRvdWNoRW5kIiwidmFsIiwibWluIiwibWF4IiwiTWF0aCIsImFkZEV2ZW50TGlzdGVuZXIiLCJib2R5Iiwic2VsZiIsInNsaWRlWSIsInRsIiwic2Nyb2xsVHJpZ2dlciIsInRyaWdnZXIiLCJzdGFydCIsInRvZ2dsZUFjdGlvbnMiLCJ0byIsInkiLCJvcGFjaXR5IiwiZHVyYXRpb24iLCJ0bDEiLCJlbmQiLCJwaW4iLCJzY3J1YiIsIm9uRW50ZXIiLCJvbkxlYXZlIiwib25MZWF2ZUJhY2siLCJvbkVudGVyQmFjayIsImRlbGF5IiwiZWFzZSIsIm9uQ29tcGxldGUiLCJjb250YWlucyIsIm1vdmVTbGlkZXIiLCJwcm9ncmVzc051bSIsImlubmVySFRNTCIsInN0eWxlIiwic2NhbGUiLCJhYnMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiaCJdLCJzb3VyY2VSb290IjoiIn0=